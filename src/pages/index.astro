---
import Landing from '../components/Landing.astro';
import Layout from '../layouts/Layout.astro';
import { Image } from "astro:assets";
import { getCollection } from 'astro:content';
import { formatProjectDate } from '../utils/dateUtils';
import { getFeaturedProjects } from '../utils/homepageUtils';

const projects = await getCollection('projects');
const displayProjects = getFeaturedProjects(projects, 6);
---

<Layout>
	<Landing />

    <!-- Featured Projects Section -->
    <section class="container mx-auto px-4 py-8">
		<h2 class="text-2xl font-semibold mb-6">Featured Projects</h2>
		<p class="mb-4 text-base-content/70">Explore my latest robotics and engineering projects.</p>
		<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
		  {displayProjects.map(project => (
			<a href={`/projects/${project.slug}/`} class="card bg-base-100 shadow-xl hover:shadow-2xl transition-shadow duration-300 ease-in-out">
			  <figure>
				<Image 
				  src={project.data.cover}
				  alt={project.data.title}
				  width={560}
				  height={315}
				  class="w-full h-auto object-cover"
				/>
			  </figure>
			  <div class="card-body">
				<h2 class="card-title">{project.data.title}</h2>
				<p class="text-sm text-base-content/70 mb-2">{project.data.description}</p>
				<div class="flex flex-wrap gap-1 mb-2">
				  {project.data.tags.slice(0, 3).map(tag => (
					<span class="badge badge-secondary badge-sm">{tag}</span>
				  ))}
				</div>
				<div class="flex justify-between items-center">
				  <span class="text-xs text-base-content/60">
					  {project.data.status === 'completed' && project.data.endDate
						  ? `Completed: ${formatProjectDate(project.data.endDate)}`
						  : project.data.status === 'in-progress'
						  ? `Started: ${formatProjectDate(project.data.startDate)}`
						  : `Planned: ${formatProjectDate(project.data.startDate)}`
					  }
				  </span>
				  <div class="badge badge-primary badge-sm">{project.data.status}</div>
				</div>
			  </div>
			</a>
		  ))}
		</div>
		<div class="flex justify-center mt-8">
		  <a href="/projects" class="btn btn-primary">View All Projects</a>
		</div>
	  </section>
</Layout>
